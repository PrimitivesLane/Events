## 主题
区块链可扩展性的解决方案

## 时间
时间：2020/07/ 02 14:00

## 地点
SNZ

## 会议参加者：

**MYKEY**：姚翔、阿福、Ricky；
**Magic Circle**：曲明、潘明慧；
**链闻**：潘致雄；
**SNZ**：Neo、冯力全；
**DeBank**：hongbo、浩川；
**Phala**：Marvin；
**安比**：郭宇；
**万向**：王琪、雨天、潘业达。

## 活动流程

### 分享
#### 主题一：路印科技的CTO Steve分享了Loopring基于zkRollup技术的实现。

首先，他给出了零知识证明的数学定义，并运用“寻找沃尔多”这个有趣的例子，从生活中切入零知识证明。接下来，介绍了当前零知识证明一般使用的技术架构，包括电路、R1CS、QAP问题以及zkSNARK框架。

接下来，Steve介绍了zkRollup的基本概念。zkRollup的基本思路就是利用zkSNARK的简洁性，将多笔交易组合生成一个结构化的证明，定期向区块链提交证明并驱动链上数据的改变。链上数据始终保持可用性，用户可以随时直接取回资产，而无需二层网络的运行者的许可。在Loopring的实现中，除了校验交易的合法性，还会检查两个数值，对充值和提现的数据进行校验。

Steve特别介绍了零知识证明的优化。针对证明者，也即二层网络的验证者，需要提高证明生成的效率，降低计算和存储开销，保证可以按时生成证明，具体的做法主要有四点：

（1）并行化。通过分层Merkle树，减小电路大小；同层哈希计算并行化；使用四叉Merkle树和波塞冬哈希并行生成零知识证明。
（2）快速FFT算法优化。针对CPU特性，优化递归算法，并且根据CPU核数分成多棵子树。
（3）指数运算乘积优化。
（4）内存优化。这里有一点可以点出，门电路是可以重复使用的，这样减少了对内存的占用。

上述优化的效果为：生成证明的成本为原来的1/15，100万笔交易的成本约为300元。

此外，Loopring还介绍了他们新的二层密钥生成的[方案](https://blogs.loopring.org/new-approach-to-generating-layer-2-account-keys-cn/)。这个方案避免了随机数不够随机可能造成的影响。

最后，Steve指出zkRollup现阶段做不到通用编程，需要为特定的场景定制。

Q&A

1. zksync 和loopring的差别？
前者只支持支付/转账，loopring的layer two除支付还可做交易，其他的区别不大，思想一样，实现上的差别

2. 什么情况需要升级？
增加代币不需要修改电路。目前升级需要用户把资产提出，再重新转入，未来的研究方向是无缝升级。

3. 郭宇补充：zkRollup的优化空间非常大，未来一两年内能有两个数量级的提升，可扩展性非常大，未来可能在电脑和手机端进行证明。

#### 主题二：第二位分享者带来了门限签名的原理及实践。
多重签名是当前实现链上资产分权管理的主要方法，但其链上开销大、不能保护隐私、且无法实现秘密的刷新。门限签名是一种新的分权管理链上资产的方法。

门限签名的工程实现主要基于最新的学术成果展开的，例如（[https://eprint.iacr.org/2019/114.pdf](https://eprint.iacr.org/2019/114.pdf)）。门限签名主要包括（1）密钥生成（2）单独签名（3）签名重组几个功能模块。相比于传统的多重签名算法，能提供更强的安全性，保护了委员会的隐私，且可扩展性强，可实现秘密刷新和动态的成员增减。但相应的，也存在一些问题。在技术层面，TSS一般引入了新的安全假设，这需要时间构建信任，而对用户来说，新算法难以理解，缺少标准化的解决方案，体验不好。

接下来，TSS与特定场景结合、集成，有可能是解决企业管理密钥的一个可突破的方向。目前RenVM和tBTC等方案已经使用了TSS。

[https://github.com/yutianwu/tss-lib](https://github.com/yutianwu/tss-lib)

#### 主题三：第三位分享人是Phala的Marvin。
Marvin之前一直蒙面出境，今天大家有幸见到庐山真面目。TEE这个技术并不新，和区块链的结合也有许多方案，Phala究竟有什么特殊之处呢？Marvin介绍，Phala主要解决的是用户、区块链、TEE之间的信任关系。

先通过远程认证，发送请求，拿到认证结果，即可认为是可信的，通过此方法让区块链认可TEE。采用读写分离的方案，让TEE和区块链进行交互。在用户和TEE之间建立可信的信道，实现信息交互。Phala可以实现机密智能合约，在保护用户隐私的情况下执行计算任务。

此外，Marvin澄清了对TEE的一些误解。例如硬件漏洞是可以修复的。一个常见的误区是，只有软件漏洞可以修复，而硬件漏洞不能修复。事实并非如此，比如英特尔为 SGX 设计了一种特殊的架构，大多数漏洞都可以通过微码及时修复。

郭宇老师现场分享了近期主要的研究方向。zkPoD是基于零知识证明的链上数据售卖方案，可以实现无托管的“一手交钱，一手交货。”此外，安比实验室还在学术上有新的进展，得到了非常好的特性，目前论文仍在投递过程。郭老师还谈到了很多研究思路与研究方法，对现场听众很有指导意义。

最后，大家就会上的相关问题展开了开放式讨论。并分享了对活动及下一次讨论的主题的看法。

### 延展讨论

**尹航：针对单笔交易，从calldata + storage + computation的角度，zkRollup是如何降低费用的？

**结论**
- calldata：没有显著降低（姚翔提出，通过对token精度的优化可以减少，但实际上这块本来占比就很小）

- storage：优化是显著的，因为实际上在ERC-20合约层面，不存在状态的修改，而只是rollup合约内的状态修改，这一部分节约了成本

- computation：优化是显著的，通过零知识证明的方式减少了onchain computation

  
**实际数据**
Steve：Loopring的一个proof可以batch一千笔tx。
姚翔：根据zkSync的数据，每笔tx的gas消耗约 0.4k。
尹航：数据是否有onchain availability

**结论**
与传统的L2方案（闪电网络、Plasma）相比，zkRollup具备一定的数据可用性，但这是不完整的数据可用性。指的是用户可以无需许可地随时从L2中提取自己的资产，但这部分余额无法与其它合约交互（例如DeFi）。

